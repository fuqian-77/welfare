(function(b){b.jqx.jqxWidget("jqxInput","",{});b.extend(b.jqx._jqxInput.prototype,{defineInstance:function(){var d=this;var a={disabled:false,filter:d._filter,sort:d._sort,highlight:d._highlight,dropDownWidth:null,renderer:d._renderer,opened:false,$popup:b("<ul></ul>"),source:[],roundedCorners:true,searchMode:"default",placeHolder:"",width:null,height:null,value:"",rtl:false,displayMember:"",valueMember:"",events:["select","open","close"],popupZIndex:20000,items:8,item:'<li><a href:"#"></a></li>',minLength:1,maxLength:null};b.extend(true,this,a);return a;},createInstance:function(a){this.render();},render:function(){if(this.element.nodeName.toLowerCase()=="textarea"){this.element.style.overflow="auto";}else{if(this.element.nodeName.toLowerCase()=="div"){this.baseHost=this.element;var a=this.host.find("input");var g=false;b.each(a,function(){var c=this.type;if(c==null||c=="text"||c=="textarea"){a=b(this);g=true;return false;}});if(!g){throw new Error("jqxInput: Missing Text Input in the Input Group");}if(a.length>0){this.baseHost=b(this.element);this.host=a;this.element=a[0];this.baseHost.addClass(this.toThemeProperty("jqx-widget"));this.baseHost.addClass(this.toThemeProperty("jqx-rc-all"));this.baseHost.addClass(this.toThemeProperty("jqx-input-group"));var h=this.baseHost.children();var f=this;b.each(h,function(c){b(this).addClass(f.toThemeProperty("jqx-input-group-addon"));b(this).removeClass(f.toThemeProperty("jqx-rc-all"));if(c==0){b(this).addClass(f.toThemeProperty("jqx-rc-l"));}if(c==h.length-1){b(this).addClass(f.toThemeProperty("jqx-rc-r"));}if(this!=f.element){b(this).addClass(f.toThemeProperty("jqx-fill-state-normal"));}});}}}this.addHandlers();if(this.rtl){this.host.addClass(this.toThemeProperty("jqx-rtl"));}this.host.attr("role","textbox");b.jqx.aria(this,"aria-autocomplete","both");b.jqx.aria(this,"aria-disabled",this.disabled);b.jqx.aria(this,"aria-readonly",false);b.jqx.aria(this,"aria-multiline",false);if(this.source&&this.source.length){b.jqx.aria(this,"aria-haspopup",true);}if(this.value!=""){this.element.value=this.value;}this._oldsource=this.source;this._updateSource();},_updateSource:function(){var e=this;var a=function(c){var d=new Array();d=b.map(c,function(k){if(k==undefined){return null;}if(typeof k==="string"||k instanceof String){return{label:k,value:k};}if(typeof k!="string"&&k instanceof String==false){var l="";var j="";if(e.displayMember!=""&&e.displayMember!=undefined){if(k[e.displayMember]){l=k[e.displayMember];}}if(e.valueMember!=""&&e.valueMember!=undefined){j=k[e.valueMember];}if(l==""){l=k.label;}if(j==""){j=k.value;}return{label:l,value:j};}return k;});return d;};if(this.source&&this.source._source){this.adapter=this.source;if(this.adapter._source.localdata!=null){this.adapter.unbindBindingUpdate(this.element.id);this.adapter.bindBindingUpdate(this.element.id,function(c){e.source=a(e.adapter.records);});}else{var f={};if(this.adapter._options.data){b.extend(e.adapter._options.data,f);}else{if(this.source._source.data){b.extend(f,this.source._source.data);}this.adapter._options.data=f;}this.adapter.unbindDownloadComplete(this.element.id);this.adapter.bindDownloadComplete(this.element.id,function(c){e.source=a(e.adapter.records);});}this.source.dataBind();return;}if(!b.isFunction(this.source)){this.source=a(this.source);}},_refreshClasses:function(d){var a=d?"addClass":"removeClass";this.host[a](this.toThemeProperty("jqx-widget-content"));this.host[a](this.toThemeProperty("jqx-input"));this.host[a](this.toThemeProperty("jqx-widget"));this.$popup[a](this.toThemeProperty("jqx-popup"));if(b.jqx.browser.msie){this.$popup[a](this.toThemeProperty("jqx-noshadow"));}this.$popup[a](this.toThemeProperty("jqx-input-popup"));this.$popup[a](this.toThemeProperty("jqx-menu"));this.$popup[a](this.toThemeProperty("jqx-menu-vertical"));this.$popup[a](this.toThemeProperty("jqx-menu-dropdown"));this.$popup[a](this.toThemeProperty("jqx-widget"));this.$popup[a](this.toThemeProperty("jqx-widget-content"));if(this.roundedCorners){this.host[a](this.toThemeProperty("jqx-rc-all"));this.$popup[a](this.toThemeProperty("jqx-rc-all"));}if(this.disabled){this.host[a](this.toThemeProperty("jqx-fill-state-disabled"));}else{this.host.removeClass(this.toThemeProperty("jqx-fill-state-disabled"));}},selectAll:function(){var a=this.host;setTimeout(function(){if("selectionStart" in a[0]){a[0].focus();a[0].setSelectionRange(0,a[0].value.length);}else{var d=a[0].createTextRange();d.collapse(true);d.moveEnd("character",a[0].value.length);d.moveStart("character",0);d.select();}},10);},selectLast:function(){var a=this.host;this.selectStart(a[0].value.length);},selectFirst:function(){var a=this.host;this.selectStart(0);},selectStart:function(d){var a=this.host;setTimeout(function(){if("selectionStart" in a[0]){a[0].focus();a[0].setSelectionRange(d,d);}else{var c=a[0].createTextRange();c.collapse(true);c.moveEnd("character",d);c.moveStart("character",d);c.select();}},10);},focus:function(){try{this.host.focus();var d=this;setTimeout(function(){d.host.focus();},25);}catch(a){}},resize:function(d,a){this.width=d;this.height=a;this.refresh();},refresh:function(){this._refreshClasses(false);this._refreshClasses(true);if(!this.baseHost){if(this.width){this.host.width(this.width);}if(this.height){this.host.height(this.height);}}else{if(this.width){this.baseHost.width(this.width);}if(this.height){this.baseHost.height(this.height);var e=this;var f=0;var a=this.baseHost.height()-2;if(b.jqx.browser.msie&&b.jqx.browser.version<8){this.baseHost.css("display","inline-block");}b.each(this.baseHost.children(),function(){b(this).css("height","100%");if(b.jqx.browser.msie&&b.jqx.browser.version<8){b(this).css("height",a+"px");}if(this!==e.element){f+=b(this).outerWidth()+2;}});this.host.css("width",this.baseHost.width()-f-4+"px");if(b.jqx.browser.msie&&b.jqx.browser.version<9){this.host.css("min-height",a+"px");this.host.css("line-height",a+"px");}}}this.host.attr("disabled",this.disabled);if(this.maxLength){this.host.attr("maxlength",this.maxLength);}if(!this.host.attr("placeholder")){this._refreshPlaceHolder();}},_refreshPlaceHolder:function(){if("placeholder" in this.element){this.host.attr("placeHolder",this.placeHolder);}else{var a=this;if(this.element.value==""){this.element.value=this.placeHolder;this.host.focus(function(){if(a.element.value==a.placeHolder){a.element.value="";}});this.host.blur(function(){if(a.element.value==""||a.element.value==a.placeHolder){a.element.value=a.placeHolder;}});}}},destroy:function(){this.removeHandlers();if(this.baseHost){this.baseHost.remove();}else{this.host.remove();}if(this.$popup){this.$popup.remove();}},propertyChangedHandler:function(a,h,f,g){if(h=="placeHolder"){a._refreshPlaceHolder();return;}if(h=="opened"){if(g){a.open();}else{a.close();}return;}if(h=="source"){a._oldsource=g;a._updateSource();}if(h=="displayMember"||h=="valueMember"){a.source=a._oldsource;a._updateSource();}if(h=="disabled"){b.jqx.aria(a,"aria-disabled",a.disabled);}if(h=="value"){a.element.value=g;}a.refresh();},select:function(h,g){var f=this.$popup.find(".jqx-fill-state-pressed").attr("data-value");var a=this.$popup.find(".jqx-fill-state-pressed").attr("data-name");this.element.value=this.renderer(a,this.element.value);this.selectedItem={label:a,value:f};this.host.attr("data-value",f);this.host.attr("data-label",a);this._raiseEvent("0",{item:{label:a,value:f},label:a,value:f});return this.close();},val:function(a){if(arguments.length==0||(a!=null&&typeof(a)=="object"&&!a.label&&!a.value)){if(this.displayMember!=""&&this.valueMember!=""&&this.selectedItem){if(this.element.value===""){return"";}return this.selectedItem;}return this.element.value;}if(a&&a.label){this.selectedItem={label:a.label,value:a.value};this.host.attr("data-value",a.value);this.host.attr("data-label",a.label);this.value=a;this.element.value=a.label;return this.element.value;}this.value=a;this.element.value=a;this.host.attr("data-value",a);this.host.attr("data-label",a);return this.element.value;},_raiseEvent:function(g,j){if(j==undefined){j={owner:null};}var i=this.events[g];j.owner=this;var h=new b.Event(i);h.owner=this;h.args=j;if(h.preventDefault){h.preventDefault();}var a=this.host.trigger(h);return a;},_renderer:function(a){return a;},open:function(){if(b.jqx.isHidden(this.host)){return;}var h=b.extend({},this.host.coord(true),{height:this.host[0].offsetHeight});if(this.$popup.parent().length==0){var f=this.element.id+"_popup";this.$popup[0].id=f;b.jqx.aria(this,"aria-owns",f);}this.$popup.appendTo(b(document.body)).css({position:"absolute",zIndex:this.popupZIndex,top:h.top+h.height,left:h.left}).show();var a=0;var g=this.$popup.children();b.each(g,function(){a+=b(this).outerHeight(true)-1;});this.$popup.height(a);this.opened=true;this._raiseEvent("1",{popup:this.$popup});b.jqx.aria(this,"aria-expanded",true);return this;},close:function(){this.$popup.hide();this.opened=false;this._raiseEvent("2",{popup:this.$popup});b.jqx.aria(this,"aria-expanded",false);return this;},suggest:function(d){var a;this.query=this.element.value;if(!this.query||this.query.length<this.minLength){return this.opened?this.close():this;}if(b.isFunction(this.source)){a=this.source(this.query,b.proxy(this.load,this));}else{a=this.source;}if(a){return this.load(a);}return this;},load:function(a){var d=this;a=b.grep(a,function(c){return d.filter(c);});a=this.sort(a);if(!a.length){if(this.opened){return this.close();}else{return this;}}return this._render(a.slice(0,this.items)).open();},_filter:function(a){var f=this.query;var e=a;if(a.label!=null){e=a.label;}else{if(this.displayMember){e=a[this.displayMember];}}switch(this.searchMode){case"none":break;case"containsignorecase":default:return b.jqx.string.containsIgnoreCase(e,f);case"contains":return b.jqx.string.contains(e,f);case"equals":return b.jqx.string.equals(e,f);case"equalsignorecase":return b.jqx.string.equalsIgnoreCase(e,f);case"startswith":return b.jqx.string.startsWith(e,f);case"startswithignorecase":return b.jqx.string.startsWithIgnoreCase(e,f);case"endswith":return b.jqx.string.endsWith(e,f);case"endswithignorecase":return b.jqx.string.endsWithIgnoreCase(e,f);}},_sort:function(a){var i=[],m=[],k=[],l;for(var n=0;n<a.length;n++){var l=a[n];var j=l;if(l.label){j=l.label;}else{if(this.displayMember){j=l[this.displayMember];}}if(j.toString().toLowerCase().indexOf(this.query.toString().toLowerCase())===0){i.push(l);}else{if(j.toString().indexOf(this.query)>=0){m.push(l);}else{if(j.toString().toLowerCase().indexOf(this.query.toString().toLowerCase())>=0){k.push(l);}}}}return i.concat(m,k);},_highlight:function(f){var e=this.query;e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var a=new RegExp("("+e+")","ig");return f.replace(a,function(d,c){return"<b>"+c+"</b>";});},_render:function(a){var d=this;a=b(a).map(function(i,h){var c=h;if(h.value!=undefined){if(h.label!=undefined){i=b(d.item).attr({"data-name":h.label,"data-value":h.value});}else{i=b(d.item).attr({"data-name":h.value,"data-value":h.value});}}else{if(h.label!=undefined){i=b(d.item).attr({"data-value":h.label,"data-name":h.label});}else{if(d.displayMember!=undefined&&d.displayMember!=""){i=b(d.item).attr({"data-name":h[d.displayMember],"data-value":h[d.valueMember]});}else{i=b(d.item).attr({"data-value":h,"data-name":h});}}}if(h.label){c=h.label;}else{if(d.displayMember){c=h[d.displayMember];}}i.find("a").html(d.highlight(c));var j="";if(d.rtl){j=" "+d.toThemeProperty("jqx-rtl");}i[0].className=d.toThemeProperty("jqx-item")+" "+d.toThemeProperty("jqx-menu-item")+" "+d.toThemeProperty("jqx-rc-all")+j;return i[0];});a.first().addClass(this.toThemeProperty("jqx-fill-state-pressed"));this.$popup.html(a);if(!this.dropDownWidth){this.$popup.width(this.host.outerWidth()-6);}else{this.$popup.width(this.dropDownWidth);}return this;},next:function(f){var e=this.$popup.find(".jqx-fill-state-pressed").removeClass(this.toThemeProperty("jqx-fill-state-pressed")),a=e.next();if(!a.length){a=b(this.$popup.find("li")[0]);}a.addClass(this.toThemeProperty("jqx-fill-state-pressed"));},prev:function(f){var e=this.$popup.find(".jqx-fill-state-pressed").removeClass(this.toThemeProperty("jqx-fill-state-pressed")),a=e.prev();if(!a.length){a=this.$popup.find("li").last();}a.addClass(this.toThemeProperty("jqx-fill-state-pressed"));},addHandlers:function(){this.addHandler(this.host,"focus",b.proxy(this.onFocus,this));this.addHandler(this.host,"blur",b.proxy(this.onBlur,this));this.addHandler(this.host,"keypress",b.proxy(this.keypress,this));this.addHandler(this.host,"keyup",b.proxy(this.keyup,this));this.addHandler(this.host,"keydown",b.proxy(this.keydown,this));this.addHandler(this.$popup,"mousedown",b.proxy(this.click,this));if(this.host.on){this.$popup.on("mouseenter","li",b.proxy(this.mouseenter,this));}else{this.$popup.bind("mouseenter","li",b.proxy(this.mouseenter,this));}},removeHandlers:function(){this.removeHandler(this.host,"focus",b.proxy(this.onFocus,this));this.removeHandler(this.host,"blur",b.proxy(this.onBlur,this));this.removeHandler(this.host,"keypress",b.proxy(this.keypress,this));this.removeHandler(this.host,"keyup",b.proxy(this.keyup,this));this.removeHandler(this.host,"keydown",b.proxy(this.keydown,this));this.removeHandler(this.$popup,"mousedown",b.proxy(this.click,this));if(this.host.off){this.$popup.off("mouseenter","li",b.proxy(this.mouseenter,this));}else{this.$popup.unbind("mouseenter","li",b.proxy(this.mouseenter,this));}},move:function(a){if(!this.opened){return;}switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:if(!a.shiftKey){a.preventDefault();this.prev();}break;case 40:if(!a.shiftKey){a.preventDefault();this.next();}break;}a.stopPropagation();},keydown:function(a){this.suppressKeyPressRepeat=~b.inArray(a.keyCode,[40,38,9,13,27]);this.move(a);},keypress:function(a){if(this.suppressKeyPressRepeat){return;}this.move(a);},keyup:function(d){switch(d.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.opened){return;}this.select(d,this);break;case 27:if(!this.opened){return;}this.close();break;default:var a=this;if(this.timer){clearTimeout(this.timer);}this.timer=setTimeout(function(){a.suggest();},300);}d.stopPropagation();d.preventDefault();},clear:function(){this.host.val("");},onBlur:function(d){var a=this;setTimeout(function(){a.close();},150);a.host.removeClass(a.toThemeProperty("jqx-fill-state-focus"));this.value=this.host.val();},onFocus:function(d){var a=this;a.host.addClass(a.toThemeProperty("jqx-fill-state-focus"));},click:function(a){a.stopPropagation();a.preventDefault();this.select(a,this);},mouseenter:function(a){this.$popup.find(".jqx-fill-state-pressed").removeClass(this.toThemeProperty("jqx-fill-state-pressed"));b(a.currentTarget).addClass(this.toThemeProperty("jqx-fill-state-pressed"));}});})(jqxBaseFramework);